cuda memory allocated: 477475328
n_trainable_params: 118948775, n_nontrainable_params: 0
training arguments:
>>> model_name: ce-qca
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x7fb94c12eaf0>
>>> learning_rate: 0.001
>>> num_epoch: 15
>>> batch_size: 24
>>> log_step: 5
>>> embed_dim: 300
>>> post_dim: 30
>>> pos_dim: 30
>>> deprel_dim: 30
>>> hidden_dim: 768
>>> num_layers: 1
>>> polarities_dim: 3
>>> input_dropout: 0.5
>>> lower: True
>>> directed: False
>>> add_self_loop: True
>>> use_rnn: False
>>> bidirect: True
>>> rnn_hidden: 60
>>> rnn_layers: 1
>>> rnn_dropout: 0.1
>>> max_length: 100
>>> device: cuda:0
>>> seed: 1000
>>> weight_decay: 0.0001
>>> vocab_dir: ./datasets/Restaurants_corenlp
>>> pad_id: 0
>>> graph_conv_type: gin
>>> graph_conv_attention_heads: 4
>>> graph_conv_attn_dropout: 0.0
>>> attention_heads: 6
>>> attn_dropout: 0.2
>>> ffn_dropout: 0.5
>>> norm: ln
>>> max_position: 9
>>> scheduler: none
>>> warmup: 2
>>> balance_loss: True
>>> cuda: 0
>>> pretrained_bert_name: bert-base-uncased
>>> adam_epsilon: 1e-08
>>> bert_dim: 768
>>> bert_dropout: 0.5
>>> bert_lr: 2e-05
>>> finetune_weight_decay: 0.01
>>> model_class: <class 'models.ce_qca.CEQCA'>
>>> dataset_file: {'train': './datasets/Restaurants_corenlp/train.json', 'test': './datasets/Restaurants_corenlp/test.json'}
>>> inputs_cols: ['text_bert_indices', 'bert_segments_ids', 'attention_mask', 'asp_start', 'asp_end', 'adj_matrix', 'src_mask', 'aspect_mask']
>>> deprel_size: 42
layered learning rate on
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
>> saved: ./state_dict/ce-qca_restaurant_acc_0.1752_f1_0.1464
loss: 1.6643, acc: 0.2917, test_acc: 0.1752, f1: 0.1464, test_loss: 2.0861
>> saved: ./state_dict/ce-qca_restaurant_acc_0.5362_f1_0.4009
loss: 1.7712, acc: 0.3750, test_acc: 0.5362, f1: 0.4009, test_loss: 1.2477
loss: 1.8320, acc: 0.3472, test_acc: 0.2511, f1: 0.2541, test_loss: 1.6377
>> saved: ./state_dict/ce-qca_restaurant_acc_0.6390_f1_0.4170
loss: 0.8148, acc: 0.4062, test_acc: 0.6390, f1: 0.4170, test_loss: 1.3011
loss: 1.7146, acc: 0.4083, test_acc: 0.3959, f1: 0.3692, test_loss: 1.1124
loss: 1.2629, acc: 0.4028, test_acc: 0.4576, f1: 0.3960, test_loss: 1.0490
loss: 1.1935, acc: 0.4167, test_acc: 0.5219, f1: 0.4159, test_loss: 1.0932
loss: 1.0104, acc: 0.4323, test_acc: 0.4781, f1: 0.4461, test_loss: 1.0125
>> saved: ./state_dict/ce-qca_restaurant_acc_0.6399_f1_0.5003
loss: 1.4248, acc: 0.4259, test_acc: 0.6399, f1: 0.5003, test_loss: 0.9774
loss: 1.2545, acc: 0.4333, test_acc: 0.5076, f1: 0.4011, test_loss: 1.0681
loss: 0.9988, acc: 0.4318, test_acc: 0.5469, f1: 0.5114, test_loss: 0.9179
>> saved: ./state_dict/ce-qca_restaurant_acc_0.7140_f1_0.5369
loss: 1.0808, acc: 0.4479, test_acc: 0.7140, f1: 0.5369, test_loss: 0.9361
loss: 0.8246, acc: 0.4615, test_acc: 0.6568, f1: 0.5270, test_loss: 0.9199
loss: 0.9383, acc: 0.4762, test_acc: 0.7024, f1: 0.5776, test_loss: 0.8508
loss: 1.0165, acc: 0.4806, test_acc: 0.6854, f1: 0.5793, test_loss: 0.8091
>> saved: ./state_dict/ce-qca_restaurant_acc_0.7149_f1_0.5534
loss: 1.3483, acc: 0.4818, test_acc: 0.7149, f1: 0.5534, test_loss: 0.8445
loss: 1.1594, acc: 0.4706, test_acc: 0.5719, f1: 0.4547, test_loss: 0.8707
>> saved: ./state_dict/ce-qca_restaurant_acc_0.7641_f1_0.5811
loss: 0.9109, acc: 0.4838, test_acc: 0.7641, f1: 0.5811, test_loss: 0.8558
loss: 0.8791, acc: 0.4978, test_acc: 0.7507, f1: 0.6224, test_loss: 0.7466
loss: 0.7172, acc: 0.5083, test_acc: 0.6828, f1: 0.6206, test_loss: 0.7171
>> saved: ./state_dict/ce-qca_restaurant_acc_0.7936_f1_0.6704
loss: 0.7348, acc: 0.5238, test_acc: 0.7936, f1: 0.6704, test_loss: 0.7434
>> saved: ./state_dict/ce-qca_restaurant_acc_0.7945_f1_0.6911
loss: 1.0724, acc: 0.5246, test_acc: 0.7945, f1: 0.6911, test_loss: 0.6832
loss: 0.5239, acc: 0.5362, test_acc: 0.7739, f1: 0.7012, test_loss: 0.6260
loss: 0.8707, acc: 0.5399, test_acc: 0.7748, f1: 0.6942, test_loss: 0.6198
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8097_f1_0.7259
loss: 0.8532, acc: 0.5433, test_acc: 0.8097, f1: 0.7259, test_loss: 0.6291
loss: 0.8935, acc: 0.5465, test_acc: 0.7784, f1: 0.6801, test_loss: 0.6411
loss: 0.8092, acc: 0.5525, test_acc: 0.8061, f1: 0.7182, test_loss: 0.6261
loss: 0.6143, acc: 0.5580, test_acc: 0.7837, f1: 0.7109, test_loss: 0.6042
loss: 0.9011, acc: 0.5589, test_acc: 0.7998, f1: 0.7222, test_loss: 0.5971
loss: 0.9137, acc: 0.5625, test_acc: 0.7748, f1: 0.7095, test_loss: 0.6210
Epoch 0 average loss: 1.1030
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 1.0786, acc: 0.7500, test_acc: 0.8088, f1: 0.6825, test_loss: 0.6935
loss: 0.5671, acc: 0.7500, test_acc: 0.8052, f1: 0.7113, test_loss: 0.5998
loss: 0.6520, acc: 0.7639, test_acc: 0.8043, f1: 0.7094, test_loss: 0.5997
loss: 0.8170, acc: 0.7292, test_acc: 0.7891, f1: 0.6735, test_loss: 0.6631
loss: 0.6290, acc: 0.7333, test_acc: 0.7828, f1: 0.7059, test_loss: 0.5952
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8141_f1_0.7194
loss: 1.0538, acc: 0.7222, test_acc: 0.8141, f1: 0.7194, test_loss: 0.6515
loss: 1.2945, acc: 0.6905, test_acc: 0.7614, f1: 0.6543, test_loss: 0.6777
loss: 0.5415, acc: 0.6979, test_acc: 0.7900, f1: 0.6939, test_loss: 0.6284
loss: 0.7407, acc: 0.7083, test_acc: 0.8088, f1: 0.7053, test_loss: 0.6537
loss: 0.5821, acc: 0.7083, test_acc: 0.7578, f1: 0.7030, test_loss: 0.5874
loss: 0.3945, acc: 0.7235, test_acc: 0.7989, f1: 0.6866, test_loss: 0.6671
loss: 0.8319, acc: 0.7222, test_acc: 0.8016, f1: 0.7107, test_loss: 0.6148
loss: 0.8950, acc: 0.7083, test_acc: 0.7819, f1: 0.7264, test_loss: 0.5569
loss: 0.8054, acc: 0.7113, test_acc: 0.7712, f1: 0.6292, test_loss: 0.7795
loss: 0.4392, acc: 0.7139, test_acc: 0.7900, f1: 0.7191, test_loss: 0.5557
loss: 0.8226, acc: 0.7240, test_acc: 0.8088, f1: 0.7103, test_loss: 0.6645
loss: 0.8167, acc: 0.7255, test_acc: 0.8105, f1: 0.6978, test_loss: 0.6773
loss: 0.6932, acc: 0.7315, test_acc: 0.7811, f1: 0.6646, test_loss: 0.7097
loss: 0.7363, acc: 0.7281, test_acc: 0.7587, f1: 0.6946, test_loss: 0.5966
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8168_f1_0.6980
loss: 1.2395, acc: 0.7229, test_acc: 0.8168, f1: 0.6980, test_loss: 0.7020
loss: 0.6219, acc: 0.7262, test_acc: 0.8034, f1: 0.7210, test_loss: 0.5650
loss: 0.6861, acc: 0.7235, test_acc: 0.7766, f1: 0.7259, test_loss: 0.5323
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8257_f1_0.7285
loss: 0.6050, acc: 0.7264, test_acc: 0.8257, f1: 0.7285, test_loss: 0.6215
loss: 0.6688, acc: 0.7309, test_acc: 0.8177, f1: 0.7565, test_loss: 0.5548
loss: 0.5113, acc: 0.7350, test_acc: 0.8213, f1: 0.7445, test_loss: 0.5476
loss: 0.9546, acc: 0.7308, test_acc: 0.8052, f1: 0.7020, test_loss: 0.6168
loss: 0.6276, acc: 0.7315, test_acc: 0.8025, f1: 0.7439, test_loss: 0.5374
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8266_f1_0.7582
loss: 0.6118, acc: 0.7321, test_acc: 0.8266, f1: 0.7582, test_loss: 0.5351
loss: 0.6840, acc: 0.7356, test_acc: 0.8204, f1: 0.7440, test_loss: 0.5593
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8293_f1_0.7611
loss: 0.7119, acc: 0.7347, test_acc: 0.8293, f1: 0.7611, test_loss: 0.5654
Epoch 1 average loss: 0.7099
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.5130, acc: 0.7500, test_acc: 0.8204, f1: 0.7003, test_loss: 0.8519
loss: 0.4845, acc: 0.7917, test_acc: 0.7998, f1: 0.6991, test_loss: 0.6351
loss: 0.6687, acc: 0.7500, test_acc: 0.7873, f1: 0.7405, test_loss: 0.5444
loss: 0.4115, acc: 0.7917, test_acc: 0.8177, f1: 0.7405, test_loss: 0.6114
loss: 0.2988, acc: 0.8250, test_acc: 0.8168, f1: 0.7398, test_loss: 0.6291
loss: 0.7490, acc: 0.8056, test_acc: 0.8159, f1: 0.7491, test_loss: 0.5808
loss: 0.3912, acc: 0.8214, test_acc: 0.8159, f1: 0.7356, test_loss: 0.6160
loss: 0.5176, acc: 0.8125, test_acc: 0.8186, f1: 0.7439, test_loss: 0.5904
loss: 0.4051, acc: 0.8148, test_acc: 0.8284, f1: 0.7624, test_loss: 0.5658
loss: 0.4821, acc: 0.8167, test_acc: 0.8284, f1: 0.7479, test_loss: 0.6229
loss: 0.6947, acc: 0.8106, test_acc: 0.8213, f1: 0.7459, test_loss: 0.5673
loss: 1.1106, acc: 0.8056, test_acc: 0.8141, f1: 0.7251, test_loss: 0.5955
loss: 0.4202, acc: 0.8109, test_acc: 0.8195, f1: 0.7619, test_loss: 0.5041
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8338_f1_0.7540
loss: 0.3247, acc: 0.8155, test_acc: 0.8338, f1: 0.7540, test_loss: 0.5752
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8365_f1_0.7636
loss: 0.2239, acc: 0.8250, test_acc: 0.8365, f1: 0.7636, test_loss: 0.5718
loss: 0.6812, acc: 0.8203, test_acc: 0.8347, f1: 0.7640, test_loss: 0.5397
loss: 0.5004, acc: 0.8186, test_acc: 0.8356, f1: 0.7482, test_loss: 0.6487
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8374_f1_0.7655
loss: 0.3760, acc: 0.8218, test_acc: 0.8374, f1: 0.7655, test_loss: 0.5731
loss: 0.4916, acc: 0.8202, test_acc: 0.8266, f1: 0.7617, test_loss: 0.5097
loss: 0.3978, acc: 0.8250, test_acc: 0.8239, f1: 0.7339, test_loss: 0.6446
loss: 0.5129, acc: 0.8254, test_acc: 0.8079, f1: 0.7557, test_loss: 0.5051
loss: 0.6958, acc: 0.8239, test_acc: 0.8213, f1: 0.7297, test_loss: 0.6626
loss: 0.1561, acc: 0.8297, test_acc: 0.8257, f1: 0.7304, test_loss: 0.6696
loss: 0.4847, acc: 0.8281, test_acc: 0.8150, f1: 0.7545, test_loss: 0.5697
loss: 0.2630, acc: 0.8317, test_acc: 0.8231, f1: 0.7298, test_loss: 0.6549
loss: 0.3518, acc: 0.8349, test_acc: 0.8311, f1: 0.7520, test_loss: 0.5908
loss: 0.7768, acc: 0.8333, test_acc: 0.8338, f1: 0.7560, test_loss: 0.6331
loss: 0.2011, acc: 0.8378, test_acc: 0.8347, f1: 0.7541, test_loss: 0.6518
loss: 0.6121, acc: 0.8348, test_acc: 0.8329, f1: 0.7602, test_loss: 0.5944
loss: 0.4846, acc: 0.8361, test_acc: 0.8311, f1: 0.7623, test_loss: 0.5758
Epoch 2 average loss: 0.4891
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.1487, acc: 1.0000, test_acc: 0.8320, f1: 0.7515, test_loss: 0.6407
loss: 0.4865, acc: 0.9375, test_acc: 0.8329, f1: 0.7487, test_loss: 0.6811
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8409_f1_0.7627
loss: 0.1527, acc: 0.9444, test_acc: 0.8409, f1: 0.7627, test_loss: 0.6222
loss: 0.5011, acc: 0.9271, test_acc: 0.8374, f1: 0.7595, test_loss: 0.6098
loss: 0.1983, acc: 0.9250, test_acc: 0.8374, f1: 0.7570, test_loss: 0.6548
loss: 0.2355, acc: 0.9236, test_acc: 0.8365, f1: 0.7544, test_loss: 0.6695
loss: 0.2378, acc: 0.9226, test_acc: 0.8391, f1: 0.7612, test_loss: 0.6121
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8445_f1_0.7673
loss: 0.3084, acc: 0.9167, test_acc: 0.8445, f1: 0.7673, test_loss: 0.6275
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8499_f1_0.7774
loss: 0.3341, acc: 0.9167, test_acc: 0.8499, f1: 0.7774, test_loss: 0.5920
loss: 0.2426, acc: 0.9167, test_acc: 0.8427, f1: 0.7676, test_loss: 0.5950
loss: 0.1288, acc: 0.9242, test_acc: 0.8374, f1: 0.7549, test_loss: 0.6203
loss: 0.3524, acc: 0.9201, test_acc: 0.8445, f1: 0.7746, test_loss: 0.5979
loss: 0.1743, acc: 0.9167, test_acc: 0.8257, f1: 0.7514, test_loss: 0.5742
loss: 0.0521, acc: 0.9226, test_acc: 0.8275, f1: 0.7355, test_loss: 0.7111
loss: 0.2707, acc: 0.9222, test_acc: 0.8338, f1: 0.7619, test_loss: 0.6026
loss: 0.3759, acc: 0.9115, test_acc: 0.8123, f1: 0.7473, test_loss: 0.5562
loss: 0.4852, acc: 0.9044, test_acc: 0.8275, f1: 0.7422, test_loss: 0.7004
loss: 0.1024, acc: 0.9074, test_acc: 0.8427, f1: 0.7610, test_loss: 0.8114
loss: 0.1567, acc: 0.9101, test_acc: 0.8248, f1: 0.7685, test_loss: 0.5588
loss: 0.2279, acc: 0.9125, test_acc: 0.8329, f1: 0.7584, test_loss: 0.6806
loss: 0.4944, acc: 0.9107, test_acc: 0.8293, f1: 0.7517, test_loss: 0.6758
loss: 0.4758, acc: 0.9053, test_acc: 0.8293, f1: 0.7704, test_loss: 0.5443
loss: 0.2406, acc: 0.9058, test_acc: 0.8266, f1: 0.7450, test_loss: 0.6404
loss: 0.4351, acc: 0.9028, test_acc: 0.8347, f1: 0.7613, test_loss: 0.6334
loss: 0.2786, acc: 0.9050, test_acc: 0.8248, f1: 0.7675, test_loss: 0.5630
loss: 0.2983, acc: 0.9054, test_acc: 0.8222, f1: 0.7415, test_loss: 0.6938
loss: 0.2975, acc: 0.9074, test_acc: 0.8266, f1: 0.7376, test_loss: 0.8274
loss: 0.2839, acc: 0.9077, test_acc: 0.8320, f1: 0.7638, test_loss: 0.6129
loss: 0.2215, acc: 0.9066, test_acc: 0.8239, f1: 0.7503, test_loss: 0.6428
loss: 0.3816, acc: 0.9056, test_acc: 0.8222, f1: 0.7361, test_loss: 0.6953
Epoch 3 average loss: 0.3252
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.2581, acc: 0.9583, test_acc: 0.8320, f1: 0.7425, test_loss: 0.7425
loss: 0.1703, acc: 0.9375, test_acc: 0.8320, f1: 0.7531, test_loss: 0.7774
loss: 0.0715, acc: 0.9583, test_acc: 0.8159, f1: 0.7348, test_loss: 0.6983
loss: 0.1706, acc: 0.9688, test_acc: 0.8213, f1: 0.7315, test_loss: 0.7868
loss: 0.0900, acc: 0.9750, test_acc: 0.8257, f1: 0.7366, test_loss: 0.9487
loss: 0.2360, acc: 0.9653, test_acc: 0.8257, f1: 0.7345, test_loss: 0.8986
loss: 0.1172, acc: 0.9583, test_acc: 0.8239, f1: 0.7519, test_loss: 0.6927
loss: 0.4013, acc: 0.9479, test_acc: 0.8168, f1: 0.7215, test_loss: 0.8354
loss: 0.1854, acc: 0.9491, test_acc: 0.8097, f1: 0.6960, test_loss: 0.9613
loss: 0.4892, acc: 0.9458, test_acc: 0.8195, f1: 0.7272, test_loss: 0.8580
loss: 0.6346, acc: 0.9280, test_acc: 0.8222, f1: 0.7487, test_loss: 0.8734
loss: 0.1461, acc: 0.9306, test_acc: 0.8186, f1: 0.7115, test_loss: 1.1070
loss: 0.3558, acc: 0.9295, test_acc: 0.8213, f1: 0.7534, test_loss: 0.7308
loss: 0.1219, acc: 0.9286, test_acc: 0.8114, f1: 0.7646, test_loss: 0.6460
loss: 0.8821, acc: 0.9194, test_acc: 0.8266, f1: 0.7539, test_loss: 0.7691
loss: 0.2846, acc: 0.9193, test_acc: 0.8284, f1: 0.7401, test_loss: 0.8818
loss: 0.3562, acc: 0.9167, test_acc: 0.8365, f1: 0.7577, test_loss: 0.8511
loss: 0.3598, acc: 0.9120, test_acc: 0.8159, f1: 0.7063, test_loss: 1.1117
loss: 0.0130, acc: 0.9167, test_acc: 0.8195, f1: 0.7098, test_loss: 1.0798
loss: 0.2408, acc: 0.9167, test_acc: 0.8311, f1: 0.7592, test_loss: 0.6773
loss: 0.2530, acc: 0.9147, test_acc: 0.8231, f1: 0.7589, test_loss: 0.6225
loss: 0.4206, acc: 0.9091, test_acc: 0.8275, f1: 0.7308, test_loss: 0.8976
loss: 0.2323, acc: 0.9094, test_acc: 0.8195, f1: 0.7165, test_loss: 0.9397
loss: 0.2534, acc: 0.9115, test_acc: 0.8338, f1: 0.7611, test_loss: 0.7764
loss: 0.2060, acc: 0.9117, test_acc: 0.8302, f1: 0.7517, test_loss: 0.8100
loss: 0.0555, acc: 0.9151, test_acc: 0.8186, f1: 0.7299, test_loss: 0.8160
loss: 0.1946, acc: 0.9136, test_acc: 0.8382, f1: 0.7703, test_loss: 0.7839
loss: 0.1297, acc: 0.9152, test_acc: 0.8418, f1: 0.7634, test_loss: 0.9333
loss: 0.0723, acc: 0.9167, test_acc: 0.8320, f1: 0.7776, test_loss: 0.6665
loss: 0.0644, acc: 0.9194, test_acc: 0.8284, f1: 0.7665, test_loss: 0.6683
loss: 0.0640, acc: 0.9203, test_acc: 0.8391, f1: 0.7662, test_loss: 0.8087
Epoch 4 average loss: 0.2468
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.1275, acc: 0.9583, test_acc: 0.8365, f1: 0.7703, test_loss: 0.7429
loss: 0.0172, acc: 0.9792, test_acc: 0.8320, f1: 0.7525, test_loss: 0.8385
loss: 0.0402, acc: 0.9861, test_acc: 0.8284, f1: 0.7434, test_loss: 0.8789
loss: 0.1149, acc: 0.9792, test_acc: 0.8347, f1: 0.7600, test_loss: 0.8077
loss: 0.0469, acc: 0.9833, test_acc: 0.8320, f1: 0.7479, test_loss: 0.9212
loss: 0.0877, acc: 0.9861, test_acc: 0.8329, f1: 0.7498, test_loss: 0.9254
loss: 0.2667, acc: 0.9762, test_acc: 0.8409, f1: 0.7741, test_loss: 0.7615
loss: 0.2355, acc: 0.9635, test_acc: 0.8293, f1: 0.7301, test_loss: 1.1136
loss: 0.5048, acc: 0.9630, test_acc: 0.8329, f1: 0.7268, test_loss: 1.2192
loss: 0.1201, acc: 0.9625, test_acc: 0.8463, f1: 0.7773, test_loss: 0.7761
loss: 0.1687, acc: 0.9583, test_acc: 0.8329, f1: 0.7774, test_loss: 0.6343
loss: 0.1699, acc: 0.9549, test_acc: 0.8427, f1: 0.7635, test_loss: 0.8631
loss: 0.1680, acc: 0.9519, test_acc: 0.8409, f1: 0.7590, test_loss: 0.9432
loss: 0.0945, acc: 0.9524, test_acc: 0.8454, f1: 0.7788, test_loss: 0.8028
loss: 0.0787, acc: 0.9556, test_acc: 0.8311, f1: 0.7622, test_loss: 0.7466
loss: 0.4271, acc: 0.9505, test_acc: 0.8293, f1: 0.7495, test_loss: 0.9061
loss: 0.0880, acc: 0.9510, test_acc: 0.8400, f1: 0.7594, test_loss: 0.9372
loss: 0.1474, acc: 0.9491, test_acc: 0.8302, f1: 0.7400, test_loss: 1.1792
loss: 0.0921, acc: 0.9496, test_acc: 0.8418, f1: 0.7773, test_loss: 0.7815
loss: 0.0869, acc: 0.9500, test_acc: 0.8391, f1: 0.7736, test_loss: 0.7646
loss: 0.0552, acc: 0.9484, test_acc: 0.8427, f1: 0.7600, test_loss: 1.0661
loss: 0.2253, acc: 0.9489, test_acc: 0.8409, f1: 0.7567, test_loss: 1.0217
loss: 0.1616, acc: 0.9493, test_acc: 0.8311, f1: 0.7729, test_loss: 0.7260
loss: 0.1169, acc: 0.9479, test_acc: 0.8311, f1: 0.7701, test_loss: 0.7514
loss: 0.1011, acc: 0.9483, test_acc: 0.8409, f1: 0.7602, test_loss: 0.9853
loss: 0.0646, acc: 0.9487, test_acc: 0.8454, f1: 0.7669, test_loss: 0.9816
loss: 0.0744, acc: 0.9491, test_acc: 0.8427, f1: 0.7794, test_loss: 0.7826
loss: 0.0077, acc: 0.9509, test_acc: 0.8436, f1: 0.7797, test_loss: 0.8042
loss: 0.0125, acc: 0.9526, test_acc: 0.8427, f1: 0.7624, test_loss: 0.9670
loss: 0.0994, acc: 0.9528, test_acc: 0.8472, f1: 0.7687, test_loss: 0.9666
Epoch 5 average loss: 0.1360
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.0066, acc: 1.0000, test_acc: 0.8463, f1: 0.7716, test_loss: 0.8987
loss: 0.1179, acc: 0.9792, test_acc: 0.8454, f1: 0.7800, test_loss: 0.8389
loss: 0.0371, acc: 0.9861, test_acc: 0.8481, f1: 0.7774, test_loss: 0.9522
loss: 0.0424, acc: 0.9792, test_acc: 0.8418, f1: 0.7614, test_loss: 1.0026
loss: 0.0715, acc: 0.9750, test_acc: 0.8266, f1: 0.7533, test_loss: 0.8687
loss: 0.1130, acc: 0.9653, test_acc: 0.8284, f1: 0.7546, test_loss: 0.8745
loss: 0.0082, acc: 0.9702, test_acc: 0.8338, f1: 0.7644, test_loss: 0.8596
loss: 0.0150, acc: 0.9740, test_acc: 0.8347, f1: 0.7685, test_loss: 0.8577
loss: 0.0314, acc: 0.9722, test_acc: 0.8382, f1: 0.7661, test_loss: 0.9485
loss: 0.0750, acc: 0.9708, test_acc: 0.8400, f1: 0.7589, test_loss: 1.0681
loss: 0.0460, acc: 0.9697, test_acc: 0.8427, f1: 0.7559, test_loss: 1.1687
loss: 0.0801, acc: 0.9722, test_acc: 0.8391, f1: 0.7593, test_loss: 1.0420
loss: 0.0720, acc: 0.9712, test_acc: 0.8400, f1: 0.7777, test_loss: 0.7680
loss: 0.1428, acc: 0.9702, test_acc: 0.8391, f1: 0.7525, test_loss: 1.2520
loss: 0.0562, acc: 0.9722, test_acc: 0.8400, f1: 0.7534, test_loss: 1.3045
loss: 0.0223, acc: 0.9740, test_acc: 0.8382, f1: 0.7519, test_loss: 1.2344
loss: 0.1357, acc: 0.9730, test_acc: 0.8338, f1: 0.7496, test_loss: 1.1612
loss: 0.0467, acc: 0.9722, test_acc: 0.8347, f1: 0.7661, test_loss: 0.9996
loss: 0.3012, acc: 0.9693, test_acc: 0.8347, f1: 0.7663, test_loss: 0.9849
loss: 0.0020, acc: 0.9708, test_acc: 0.8347, f1: 0.7494, test_loss: 1.1750
loss: 0.2074, acc: 0.9702, test_acc: 0.8266, f1: 0.7348, test_loss: 1.2927
loss: 0.0464, acc: 0.9716, test_acc: 0.8329, f1: 0.7674, test_loss: 0.8937
loss: 0.1387, acc: 0.9692, test_acc: 0.8338, f1: 0.7594, test_loss: 0.9423
loss: 0.0547, acc: 0.9688, test_acc: 0.8338, f1: 0.7476, test_loss: 1.1628
loss: 0.0708, acc: 0.9667, test_acc: 0.8329, f1: 0.7622, test_loss: 0.9478
loss: 0.0411, acc: 0.9663, test_acc: 0.8356, f1: 0.7696, test_loss: 0.8529
loss: 0.0854, acc: 0.9660, test_acc: 0.8409, f1: 0.7703, test_loss: 0.9654
loss: 0.0626, acc: 0.9673, test_acc: 0.8418, f1: 0.7555, test_loss: 1.2837
loss: 0.0452, acc: 0.9684, test_acc: 0.8400, f1: 0.7555, test_loss: 1.2490
loss: 0.0343, acc: 0.9694, test_acc: 0.8365, f1: 0.7530, test_loss: 1.2586
Epoch 6 average loss: 0.0843
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.0084, acc: 1.0000, test_acc: 0.8374, f1: 0.7567, test_loss: 1.2645
loss: 0.0373, acc: 1.0000, test_acc: 0.8356, f1: 0.7588, test_loss: 1.1318
loss: 0.0181, acc: 1.0000, test_acc: 0.8365, f1: 0.7597, test_loss: 1.1661
loss: 0.0416, acc: 0.9896, test_acc: 0.8329, f1: 0.7415, test_loss: 1.4102
loss: 0.1322, acc: 0.9833, test_acc: 0.8382, f1: 0.7578, test_loss: 1.2671
loss: 0.0195, acc: 0.9861, test_acc: 0.8374, f1: 0.7590, test_loss: 1.1913
loss: 0.0022, acc: 0.9881, test_acc: 0.8382, f1: 0.7530, test_loss: 1.4177
loss: 0.0048, acc: 0.9896, test_acc: 0.8347, f1: 0.7468, test_loss: 1.4174
loss: 0.0424, acc: 0.9861, test_acc: 0.8382, f1: 0.7498, test_loss: 1.3502
loss: 0.0064, acc: 0.9875, test_acc: 0.8338, f1: 0.7467, test_loss: 1.3252
loss: 0.0596, acc: 0.9848, test_acc: 0.8391, f1: 0.7605, test_loss: 1.2934
loss: 0.0491, acc: 0.9826, test_acc: 0.8445, f1: 0.7697, test_loss: 1.1514
loss: 0.0008, acc: 0.9840, test_acc: 0.8436, f1: 0.7757, test_loss: 1.1096
loss: 0.0058, acc: 0.9851, test_acc: 0.8454, f1: 0.7753, test_loss: 1.1929
loss: 0.1559, acc: 0.9833, test_acc: 0.8427, f1: 0.7587, test_loss: 1.3852
loss: 0.3762, acc: 0.9818, test_acc: 0.8374, f1: 0.7471, test_loss: 1.3907
loss: 0.0051, acc: 0.9828, test_acc: 0.8454, f1: 0.7829, test_loss: 0.9719
loss: 0.1115, acc: 0.9815, test_acc: 0.8454, f1: 0.7836, test_loss: 0.9534
loss: 0.0151, acc: 0.9825, test_acc: 0.8382, f1: 0.7577, test_loss: 1.4020
loss: 0.0145, acc: 0.9833, test_acc: 0.8239, f1: 0.7132, test_loss: 1.7772
loss: 0.0061, acc: 0.9841, test_acc: 0.8266, f1: 0.7315, test_loss: 1.4418
loss: 0.0124, acc: 0.9848, test_acc: 0.8266, f1: 0.7580, test_loss: 1.0135
loss: 0.0149, acc: 0.9855, test_acc: 0.8365, f1: 0.7671, test_loss: 1.0864
loss: 0.2105, acc: 0.9826, test_acc: 0.8382, f1: 0.7592, test_loss: 1.4149
loss: 0.0049, acc: 0.9833, test_acc: 0.8391, f1: 0.7535, test_loss: 1.5922
loss: 0.0089, acc: 0.9840, test_acc: 0.8391, f1: 0.7749, test_loss: 1.0437
loss: 0.0815, acc: 0.9815, test_acc: 0.8418, f1: 0.7695, test_loss: 1.1559
loss: 0.0636, acc: 0.9807, test_acc: 0.8311, f1: 0.7379, test_loss: 1.3574
loss: 0.1457, acc: 0.9813, test_acc: 0.8436, f1: 0.7725, test_loss: 1.1281
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8543_f1_0.7937
loss: 0.1216, acc: 0.9792, test_acc: 0.8543, f1: 0.7937, test_loss: 1.1123
Epoch 7 average loss: 0.0627
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.0620, acc: 1.0000, test_acc: 0.8382, f1: 0.7587, test_loss: 1.4864
loss: 0.0492, acc: 1.0000, test_acc: 0.8365, f1: 0.7447, test_loss: 1.4087
loss: 0.0614, acc: 1.0000, test_acc: 0.8347, f1: 0.7579, test_loss: 1.1120
loss: 0.3932, acc: 0.9688, test_acc: 0.8463, f1: 0.7806, test_loss: 0.9763
loss: 0.0207, acc: 0.9750, test_acc: 0.8356, f1: 0.7328, test_loss: 1.5230
loss: 0.0480, acc: 0.9792, test_acc: 0.8275, f1: 0.7089, test_loss: 1.9695
loss: 0.2154, acc: 0.9762, test_acc: 0.8427, f1: 0.7704, test_loss: 0.9993
loss: 0.3398, acc: 0.9583, test_acc: 0.7971, f1: 0.7491, test_loss: 0.8530
loss: 0.0253, acc: 0.9583, test_acc: 0.8382, f1: 0.7567, test_loss: 1.1434
loss: 0.0314, acc: 0.9625, test_acc: 0.8356, f1: 0.7323, test_loss: 1.5824
loss: 0.1687, acc: 0.9583, test_acc: 0.8409, f1: 0.7769, test_loss: 0.9295
loss: 0.0485, acc: 0.9583, test_acc: 0.8391, f1: 0.7831, test_loss: 0.8729
loss: 0.0297, acc: 0.9583, test_acc: 0.8409, f1: 0.7640, test_loss: 1.1366
loss: 0.0084, acc: 0.9613, test_acc: 0.8329, f1: 0.7239, test_loss: 1.5576
loss: 0.0440, acc: 0.9639, test_acc: 0.8329, f1: 0.7232, test_loss: 1.5976
loss: 0.0496, acc: 0.9661, test_acc: 0.8409, f1: 0.7514, test_loss: 1.3276
loss: 0.1292, acc: 0.9657, test_acc: 0.8374, f1: 0.7682, test_loss: 0.9730
loss: 0.1423, acc: 0.9630, test_acc: 0.8409, f1: 0.7880, test_loss: 0.8426
loss: 0.0130, acc: 0.9649, test_acc: 0.8499, f1: 0.7887, test_loss: 0.9296
loss: 0.1366, acc: 0.9646, test_acc: 0.8499, f1: 0.7726, test_loss: 1.2120
loss: 0.0132, acc: 0.9663, test_acc: 0.8338, f1: 0.7261, test_loss: 1.6596
loss: 0.0311, acc: 0.9678, test_acc: 0.8338, f1: 0.7264, test_loss: 1.5911
loss: 0.0090, acc: 0.9692, test_acc: 0.8517, f1: 0.7785, test_loss: 1.1214
loss: 0.0049, acc: 0.9705, test_acc: 0.8525, f1: 0.7845, test_loss: 1.0620
loss: 0.0600, acc: 0.9700, test_acc: 0.8534, f1: 0.7829, test_loss: 1.0682
loss: 0.0262, acc: 0.9712, test_acc: 0.8490, f1: 0.7758, test_loss: 1.0933
loss: 0.0884, acc: 0.9707, test_acc: 0.8499, f1: 0.7767, test_loss: 1.1429
loss: 0.0640, acc: 0.9688, test_acc: 0.8427, f1: 0.7579, test_loss: 1.2946
loss: 0.0553, acc: 0.9698, test_acc: 0.8481, f1: 0.7681, test_loss: 1.3592
loss: 0.0496, acc: 0.9708, test_acc: 0.8472, f1: 0.7673, test_loss: 1.2978
Epoch 8 average loss: 0.0779
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.0189, acc: 1.0000, test_acc: 0.8400, f1: 0.7503, test_loss: 1.3968
loss: 0.0055, acc: 1.0000, test_acc: 0.8356, f1: 0.7447, test_loss: 1.3889
loss: 0.0034, acc: 1.0000, test_acc: 0.8445, f1: 0.7686, test_loss: 1.1636
loss: 0.0017, acc: 1.0000, test_acc: 0.8508, f1: 0.7836, test_loss: 1.0628
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8561_f1_0.7926
loss: 0.0032, acc: 1.0000, test_acc: 0.8561, f1: 0.7926, test_loss: 1.0433
loss: 0.0720, acc: 0.9931, test_acc: 0.8525, f1: 0.7819, test_loss: 1.2099
loss: 0.0017, acc: 0.9940, test_acc: 0.8454, f1: 0.7611, test_loss: 1.4257
loss: 0.0010, acc: 0.9948, test_acc: 0.8409, f1: 0.7479, test_loss: 1.5376
loss: 0.0195, acc: 0.9954, test_acc: 0.8409, f1: 0.7459, test_loss: 1.5809
loss: 0.0038, acc: 0.9958, test_acc: 0.8427, f1: 0.7546, test_loss: 1.4625
loss: 0.0035, acc: 0.9962, test_acc: 0.8418, f1: 0.7562, test_loss: 1.3995
loss: 0.0580, acc: 0.9931, test_acc: 0.8374, f1: 0.7481, test_loss: 1.4064
loss: 0.0264, acc: 0.9936, test_acc: 0.8499, f1: 0.7710, test_loss: 1.3330
loss: 0.0100, acc: 0.9940, test_acc: 0.8463, f1: 0.7717, test_loss: 1.3180
loss: 0.0016, acc: 0.9944, test_acc: 0.8490, f1: 0.7749, test_loss: 1.3613
loss: 0.0104, acc: 0.9948, test_acc: 0.8409, f1: 0.7556, test_loss: 1.6350
loss: 0.0758, acc: 0.9926, test_acc: 0.8481, f1: 0.7745, test_loss: 1.3847
loss: 0.1211, acc: 0.9907, test_acc: 0.8418, f1: 0.7741, test_loss: 1.1249
loss: 0.0254, acc: 0.9912, test_acc: 0.8382, f1: 0.7562, test_loss: 1.3677
loss: 0.0050, acc: 0.9917, test_acc: 0.8356, f1: 0.7358, test_loss: 1.7319
loss: 0.0015, acc: 0.9921, test_acc: 0.8347, f1: 0.7341, test_loss: 1.8551
loss: 0.0014, acc: 0.9924, test_acc: 0.8472, f1: 0.7717, test_loss: 1.4265
loss: 0.0113, acc: 0.9928, test_acc: 0.8508, f1: 0.7803, test_loss: 1.2286
loss: 0.0051, acc: 0.9931, test_acc: 0.8481, f1: 0.7777, test_loss: 1.2073
loss: 0.0215, acc: 0.9933, test_acc: 0.8499, f1: 0.7803, test_loss: 1.2297
loss: 0.0082, acc: 0.9936, test_acc: 0.8517, f1: 0.7912, test_loss: 1.0207
loss: 0.0008, acc: 0.9938, test_acc: 0.8561, f1: 0.7941, test_loss: 1.0738
loss: 0.0277, acc: 0.9926, test_acc: 0.8499, f1: 0.7735, test_loss: 1.3178
loss: 0.2558, acc: 0.9914, test_acc: 0.8490, f1: 0.7722, test_loss: 1.4734
loss: 0.0135, acc: 0.9917, test_acc: 0.8525, f1: 0.7884, test_loss: 1.1354
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8597_f1_0.8075
loss: 0.0033, acc: 0.9918, test_acc: 0.8597, f1: 0.8075, test_loss: 0.9900
Epoch 9 average loss: 0.0327
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.0311, acc: 1.0000, test_acc: 0.8570, f1: 0.8019, test_loss: 1.0360
loss: 0.0450, acc: 1.0000, test_acc: 0.8409, f1: 0.7622, test_loss: 1.4694
loss: 0.0017, acc: 1.0000, test_acc: 0.8329, f1: 0.7408, test_loss: 1.5501
loss: 0.0014, acc: 1.0000, test_acc: 0.8463, f1: 0.7800, test_loss: 1.1883
loss: 0.0163, acc: 1.0000, test_acc: 0.8409, f1: 0.7778, test_loss: 1.1087
loss: 0.3343, acc: 0.9861, test_acc: 0.8427, f1: 0.7754, test_loss: 1.1852
loss: 0.0697, acc: 0.9762, test_acc: 0.8338, f1: 0.7467, test_loss: 1.5426
loss: 0.0020, acc: 0.9792, test_acc: 0.8320, f1: 0.7427, test_loss: 1.6558
loss: 0.0014, acc: 0.9815, test_acc: 0.8338, f1: 0.7460, test_loss: 1.6248
loss: 0.1014, acc: 0.9750, test_acc: 0.8347, f1: 0.7516, test_loss: 1.5586
loss: 0.0284, acc: 0.9735, test_acc: 0.8356, f1: 0.7562, test_loss: 1.4724
loss: 0.0008, acc: 0.9757, test_acc: 0.8338, f1: 0.7543, test_loss: 1.4502
loss: 0.0002, acc: 0.9776, test_acc: 0.8338, f1: 0.7486, test_loss: 1.7275
loss: 0.0005, acc: 0.9792, test_acc: 0.8320, f1: 0.7386, test_loss: 1.9141
loss: 0.0986, acc: 0.9750, test_acc: 0.8320, f1: 0.7386, test_loss: 1.8564
loss: 0.0403, acc: 0.9740, test_acc: 0.8374, f1: 0.7505, test_loss: 1.5181
loss: 0.0061, acc: 0.9755, test_acc: 0.8374, f1: 0.7486, test_loss: 1.5794
loss: 0.0204, acc: 0.9769, test_acc: 0.8409, f1: 0.7564, test_loss: 1.4798
loss: 0.0015, acc: 0.9781, test_acc: 0.8445, f1: 0.7748, test_loss: 1.2117
loss: 0.0051, acc: 0.9792, test_acc: 0.8481, f1: 0.7859, test_loss: 1.0514
loss: 0.0116, acc: 0.9802, test_acc: 0.8543, f1: 0.7951, test_loss: 1.0925
loss: 0.0015, acc: 0.9811, test_acc: 0.8517, f1: 0.7882, test_loss: 1.2126
loss: 0.0833, acc: 0.9801, test_acc: 0.8499, f1: 0.7779, test_loss: 1.3893
loss: 0.0065, acc: 0.9809, test_acc: 0.8499, f1: 0.7754, test_loss: 1.4760
loss: 0.0001, acc: 0.9817, test_acc: 0.8517, f1: 0.7818, test_loss: 1.4149
loss: 0.0141, acc: 0.9824, test_acc: 0.8525, f1: 0.7832, test_loss: 1.3876
loss: 0.0001, acc: 0.9830, test_acc: 0.8517, f1: 0.7772, test_loss: 1.5164
loss: 0.1971, acc: 0.9792, test_acc: 0.8365, f1: 0.7432, test_loss: 1.7810
loss: 0.0001, acc: 0.9799, test_acc: 0.8427, f1: 0.7662, test_loss: 1.4791
loss: 0.0007, acc: 0.9806, test_acc: 0.8499, f1: 0.7793, test_loss: 1.3333
Epoch 10 average loss: 0.0328
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.0017, acc: 1.0000, test_acc: 0.8463, f1: 0.7724, test_loss: 1.3802
loss: 0.0009, acc: 1.0000, test_acc: 0.8472, f1: 0.7726, test_loss: 1.5589
loss: 0.0380, acc: 1.0000, test_acc: 0.8499, f1: 0.7777, test_loss: 1.5537
loss: 0.0364, acc: 1.0000, test_acc: 0.8481, f1: 0.7743, test_loss: 1.5519
loss: 0.0041, acc: 1.0000, test_acc: 0.8400, f1: 0.7509, test_loss: 1.6514
loss: 0.0043, acc: 1.0000, test_acc: 0.8239, f1: 0.7165, test_loss: 1.9028
loss: 0.0887, acc: 0.9940, test_acc: 0.8311, f1: 0.7359, test_loss: 1.7212
loss: 0.0027, acc: 0.9948, test_acc: 0.8347, f1: 0.7495, test_loss: 1.4075
loss: 0.1774, acc: 0.9815, test_acc: 0.8517, f1: 0.7962, test_loss: 1.1155
loss: 0.0024, acc: 0.9833, test_acc: 0.8490, f1: 0.7888, test_loss: 1.1532
loss: 0.0510, acc: 0.9848, test_acc: 0.8454, f1: 0.7812, test_loss: 1.1610
loss: 0.0030, acc: 0.9861, test_acc: 0.8445, f1: 0.7799, test_loss: 1.1671
loss: 0.0018, acc: 0.9872, test_acc: 0.8454, f1: 0.7739, test_loss: 1.2512
loss: 0.0106, acc: 0.9881, test_acc: 0.8400, f1: 0.7597, test_loss: 1.4226
loss: 0.0200, acc: 0.9889, test_acc: 0.8365, f1: 0.7469, test_loss: 1.7087
loss: 0.0154, acc: 0.9896, test_acc: 0.8347, f1: 0.7355, test_loss: 1.8818
loss: 0.0059, acc: 0.9902, test_acc: 0.8382, f1: 0.7599, test_loss: 1.2957
loss: 0.0400, acc: 0.9884, test_acc: 0.8338, f1: 0.7773, test_loss: 1.1057
loss: 0.1467, acc: 0.9868, test_acc: 0.8472, f1: 0.7801, test_loss: 1.4000
loss: 0.1241, acc: 0.9854, test_acc: 0.8400, f1: 0.7482, test_loss: 1.9574
loss: 0.1032, acc: 0.9841, test_acc: 0.8391, f1: 0.7481, test_loss: 1.8698
loss: 0.0006, acc: 0.9848, test_acc: 0.8463, f1: 0.7753, test_loss: 1.3559
loss: 0.0122, acc: 0.9855, test_acc: 0.8481, f1: 0.7781, test_loss: 1.3832
loss: 0.0023, acc: 0.9861, test_acc: 0.8588, f1: 0.7998, test_loss: 1.3849
loss: 0.0975, acc: 0.9850, test_acc: 0.8472, f1: 0.7762, test_loss: 1.6515
loss: 0.0014, acc: 0.9856, test_acc: 0.8409, f1: 0.7462, test_loss: 2.4340
loss: 0.0066, acc: 0.9861, test_acc: 0.8454, f1: 0.7679, test_loss: 1.5868
loss: 0.6017, acc: 0.9851, test_acc: 0.8517, f1: 0.7990, test_loss: 1.0841
loss: 0.0401, acc: 0.9842, test_acc: 0.8463, f1: 0.7961, test_loss: 0.9881
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8660_f1_0.8107
loss: 0.0404, acc: 0.9833, test_acc: 0.8660, f1: 0.8107, test_loss: 1.1221
Epoch 11 average loss: 0.0403
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.0400, acc: 0.9583, test_acc: 0.8597, f1: 0.7926, test_loss: 1.4000
loss: 0.0006, acc: 0.9792, test_acc: 0.8606, f1: 0.7966, test_loss: 1.3393
loss: 0.0038, acc: 0.9861, test_acc: 0.8615, f1: 0.7985, test_loss: 1.3758
loss: 0.0002, acc: 0.9896, test_acc: 0.8624, f1: 0.8012, test_loss: 1.3425
loss: 0.0133, acc: 0.9917, test_acc: 0.8651, f1: 0.8041, test_loss: 1.2265
loss: 0.0003, acc: 0.9931, test_acc: 0.8606, f1: 0.8056, test_loss: 1.0750
loss: 0.0030, acc: 0.9940, test_acc: 0.8597, f1: 0.8046, test_loss: 1.0721
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8686_f1_0.8083
loss: 0.0046, acc: 0.9948, test_acc: 0.8686, f1: 0.8083, test_loss: 1.2317
loss: 0.1174, acc: 0.9907, test_acc: 0.8615, f1: 0.7932, test_loss: 1.4831
loss: 0.0157, acc: 0.9917, test_acc: 0.8517, f1: 0.7672, test_loss: 1.8322
loss: 0.0713, acc: 0.9886, test_acc: 0.8463, f1: 0.7498, test_loss: 1.8688
loss: 0.0003, acc: 0.9896, test_acc: 0.8668, f1: 0.8031, test_loss: 1.3087
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8704_f1_0.8169
loss: 0.0006, acc: 0.9904, test_acc: 0.8704, f1: 0.8169, test_loss: 1.0632
loss: 0.1421, acc: 0.9881, test_acc: 0.8695, f1: 0.8188, test_loss: 1.0110
loss: 0.0051, acc: 0.9889, test_acc: 0.8624, f1: 0.8134, test_loss: 0.9973
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8731_f1_0.8178
loss: 0.0218, acc: 0.9896, test_acc: 0.8731, f1: 0.8178, test_loss: 1.2747
loss: 0.0029, acc: 0.9902, test_acc: 0.8606, f1: 0.7915, test_loss: 1.7373
loss: 0.0004, acc: 0.9907, test_acc: 0.8660, f1: 0.8109, test_loss: 1.1862
loss: 0.1330, acc: 0.9890, test_acc: 0.8329, f1: 0.7885, test_loss: 0.9430
loss: 0.0176, acc: 0.9896, test_acc: 0.8525, f1: 0.7892, test_loss: 1.1367
loss: 0.1886, acc: 0.9881, test_acc: 0.8597, f1: 0.7872, test_loss: 1.5105
loss: 0.0237, acc: 0.9886, test_acc: 0.8588, f1: 0.7945, test_loss: 1.3678
loss: 0.0026, acc: 0.9891, test_acc: 0.8579, f1: 0.7933, test_loss: 1.3157
loss: 0.0507, acc: 0.9878, test_acc: 0.8615, f1: 0.7953, test_loss: 1.3816
loss: 0.0075, acc: 0.9883, test_acc: 0.8543, f1: 0.7820, test_loss: 1.3529
loss: 0.1950, acc: 0.9856, test_acc: 0.8481, f1: 0.7949, test_loss: 0.9921
loss: 0.1438, acc: 0.9830, test_acc: 0.8525, f1: 0.7994, test_loss: 0.9333
loss: 0.0678, acc: 0.9836, test_acc: 0.8633, f1: 0.8023, test_loss: 1.2683
loss: 0.0185, acc: 0.9842, test_acc: 0.8579, f1: 0.7893, test_loss: 1.3662
loss: 0.0021, acc: 0.9847, test_acc: 0.8534, f1: 0.7876, test_loss: 1.2412
Epoch 12 average loss: 0.0439
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.0062, acc: 1.0000, test_acc: 0.8436, f1: 0.7781, test_loss: 1.2107
loss: 0.0143, acc: 1.0000, test_acc: 0.8463, f1: 0.7764, test_loss: 1.2967
loss: 0.0893, acc: 0.9722, test_acc: 0.8490, f1: 0.7745, test_loss: 1.4576
loss: 0.0235, acc: 0.9792, test_acc: 0.8517, f1: 0.7758, test_loss: 1.5326
loss: 0.0034, acc: 0.9833, test_acc: 0.8508, f1: 0.7777, test_loss: 1.6522
loss: 0.1135, acc: 0.9792, test_acc: 0.8525, f1: 0.7820, test_loss: 1.6609
loss: 0.0011, acc: 0.9821, test_acc: 0.8517, f1: 0.7786, test_loss: 1.6548
loss: 0.0012, acc: 0.9844, test_acc: 0.8382, f1: 0.7477, test_loss: 1.8148
loss: 0.0010, acc: 0.9861, test_acc: 0.8445, f1: 0.7648, test_loss: 1.5627
loss: 0.0014, acc: 0.9875, test_acc: 0.8525, f1: 0.7828, test_loss: 1.3321
loss: 0.0159, acc: 0.9886, test_acc: 0.8517, f1: 0.7855, test_loss: 1.2277
loss: 0.2329, acc: 0.9861, test_acc: 0.8490, f1: 0.7924, test_loss: 1.0209
loss: 0.0076, acc: 0.9872, test_acc: 0.8490, f1: 0.7916, test_loss: 1.0126
loss: 0.0621, acc: 0.9851, test_acc: 0.8463, f1: 0.7739, test_loss: 1.1819
loss: 0.0826, acc: 0.9833, test_acc: 0.8418, f1: 0.7536, test_loss: 1.5788
loss: 0.0157, acc: 0.9844, test_acc: 0.8481, f1: 0.7710, test_loss: 1.4039
loss: 0.2107, acc: 0.9804, test_acc: 0.8418, f1: 0.7776, test_loss: 1.1100
loss: 0.0120, acc: 0.9815, test_acc: 0.8409, f1: 0.7756, test_loss: 1.1757
loss: 0.0310, acc: 0.9803, test_acc: 0.8454, f1: 0.7761, test_loss: 1.2918
loss: 0.1189, acc: 0.9792, test_acc: 0.8400, f1: 0.7549, test_loss: 1.5527
loss: 0.0013, acc: 0.9802, test_acc: 0.8436, f1: 0.7659, test_loss: 1.5322
loss: 0.0015, acc: 0.9811, test_acc: 0.8436, f1: 0.7727, test_loss: 1.2572
loss: 0.0017, acc: 0.9819, test_acc: 0.8409, f1: 0.7692, test_loss: 1.3031
loss: 0.0015, acc: 0.9826, test_acc: 0.8356, f1: 0.7556, test_loss: 1.4236
loss: 0.5054, acc: 0.9817, test_acc: 0.8329, f1: 0.7476, test_loss: 1.5104
loss: 0.0057, acc: 0.9824, test_acc: 0.8248, f1: 0.7502, test_loss: 1.3035
loss: 0.1271, acc: 0.9815, test_acc: 0.8195, f1: 0.7493, test_loss: 1.3012
loss: 0.0059, acc: 0.9821, test_acc: 0.8365, f1: 0.7608, test_loss: 1.2928
loss: 0.0005, acc: 0.9828, test_acc: 0.8427, f1: 0.7726, test_loss: 1.1803
loss: 0.0648, acc: 0.9819, test_acc: 0.8338, f1: 0.7518, test_loss: 1.3686
Epoch 13 average loss: 0.0467
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.0017, acc: 1.0000, test_acc: 0.8365, f1: 0.7578, test_loss: 1.2541
loss: 0.0761, acc: 0.9583, test_acc: 0.8374, f1: 0.7648, test_loss: 1.1520
loss: 0.0910, acc: 0.9583, test_acc: 0.8391, f1: 0.7654, test_loss: 1.2325
loss: 0.0155, acc: 0.9688, test_acc: 0.8365, f1: 0.7573, test_loss: 1.2314
loss: 0.0078, acc: 0.9750, test_acc: 0.8347, f1: 0.7583, test_loss: 1.2340
loss: 0.0137, acc: 0.9792, test_acc: 0.8347, f1: 0.7646, test_loss: 1.1964
loss: 0.0595, acc: 0.9762, test_acc: 0.8347, f1: 0.7630, test_loss: 1.2345
loss: 0.0239, acc: 0.9792, test_acc: 0.8266, f1: 0.7433, test_loss: 1.4620
loss: 0.0004, acc: 0.9815, test_acc: 0.8293, f1: 0.7411, test_loss: 1.5943
loss: 0.0009, acc: 0.9833, test_acc: 0.8320, f1: 0.7452, test_loss: 1.6340
loss: 0.0803, acc: 0.9811, test_acc: 0.8311, f1: 0.7444, test_loss: 1.6339
loss: 0.0005, acc: 0.9826, test_acc: 0.8302, f1: 0.7332, test_loss: 1.8173
loss: 0.0017, acc: 0.9840, test_acc: 0.8231, f1: 0.7255, test_loss: 1.8388
loss: 0.0400, acc: 0.9821, test_acc: 0.8257, f1: 0.7303, test_loss: 1.8184
loss: 0.0000, acc: 0.9833, test_acc: 0.8329, f1: 0.7464, test_loss: 1.6307
loss: 0.0371, acc: 0.9844, test_acc: 0.8418, f1: 0.7701, test_loss: 1.4086
loss: 0.0124, acc: 0.9853, test_acc: 0.8454, f1: 0.7750, test_loss: 1.5647
loss: 0.4241, acc: 0.9792, test_acc: 0.8382, f1: 0.7573, test_loss: 1.6092
loss: 0.0311, acc: 0.9803, test_acc: 0.8079, f1: 0.6952, test_loss: 2.0054
loss: 0.0037, acc: 0.9812, test_acc: 0.8302, f1: 0.7497, test_loss: 1.4011
loss: 0.0161, acc: 0.9821, test_acc: 0.8400, f1: 0.7707, test_loss: 1.4008
loss: 0.0328, acc: 0.9830, test_acc: 0.8365, f1: 0.7596, test_loss: 1.5404
loss: 0.0803, acc: 0.9819, test_acc: 0.8284, f1: 0.7337, test_loss: 1.7615
loss: 0.0510, acc: 0.9826, test_acc: 0.8213, f1: 0.7101, test_loss: 2.0234
loss: 0.0245, acc: 0.9833, test_acc: 0.8374, f1: 0.7509, test_loss: 1.5162
loss: 0.2404, acc: 0.9808, test_acc: 0.8508, f1: 0.7939, test_loss: 1.0973
loss: 0.0148, acc: 0.9815, test_acc: 0.8615, f1: 0.8078, test_loss: 1.1273
loss: 0.0055, acc: 0.9821, test_acc: 0.8517, f1: 0.7771, test_loss: 1.4086
loss: 0.0040, acc: 0.9828, test_acc: 0.8445, f1: 0.7621, test_loss: 1.7374
loss: 0.0011, acc: 0.9833, test_acc: 0.8534, f1: 0.7859, test_loss: 1.3757
loss: 0.0000, acc: 0.9835, test_acc: 0.8543, f1: 0.7971, test_loss: 1.2385
Epoch 14 average loss: 0.0455
Loss plot saved to ./loss_plots/ce-qca2t_loss_plot_20240805_0051.png
max_test_acc: 0.8731009830205541, max_f1: 0.8188330913120351
>> saved: ./state_dict/ce-qca_restaurant_acc_0.8731_f1_0.8178
############################################################
max_test_acc_overall:0.8731009830205541
max_f1_overall:0.8188330913120351
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

           0     0.8939    0.9615    0.9264       727
           1     0.9108    0.7296    0.8102       196
           2     0.7389    0.6786    0.7074       196

    accuracy                         0.8713      1119
   macro avg     0.8479    0.7899    0.8147      1119
weighted avg     0.8697    0.8713    0.8677      1119

Confusion Matrix...
[[699   3  25]
 [ 31 143  22]
 [ 52  11 133]]
